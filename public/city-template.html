<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{title}}</title>
  <meta name="description" content="{{description}}" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{title}}" />
  <meta property="og:description" content="{{description}}" />
  <meta property="og:image" content="{{imageUrl}}" />
  <meta property="og:url" content="{{canonicalUrl}}" />
  <meta name="date" content="{{date}}" />
  <link rel="canonical" href="{{canonicalUrl}}" />
  <meta name="robots" content="index,follow" />
  
  <!-- ✅ 공통 스타일 -->
  <link rel="stylesheet" href="/css/common.css">
  <link rel="stylesheet" href="/css/home.css">
</head>

<body>
  {{HEADER_SEARCH}}

<main style="max-width:900px;margin:60px auto;padding:0 20px;">
  <section class="hotel-section">
    <h2>{{cityName}} 인기 숙소</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-top">‹</button>
      <div class="horizontal-scroll" id="hotelList-top"></div>
      <button class="scroll-btn right" data-target="hotelList-top">›</button>
    </div>
  </section>

  <section class="hotel-section">
    <h2>가족과 함께하기 좋은 숙소</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-family">‹</button>
      <div class="horizontal-scroll" id="hotelList-family"></div>
      <button class="scroll-btn right" data-target="hotelList-family">›</button>
    </div>
  </section>

  <section class="hotel-section">
    <h2>반려동물 동반 숙소</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-pet">‹</button>
      <div class="horizontal-scroll" id="hotelList-pet"></div>
      <button class="scroll-btn right" data-target="hotelList-pet">›</button>
    </div>
  </section>
</main>


  <footer>ⓒ 2025 RapidStay | Expedia Partner Data 기반</footer>

  <!-- === JS === -->
  <script type="module">
    import { TARGET_CITIES } from "/js/cities.js";
    window.citySlugMap = Object.fromEntries(
      TARGET_CITIES.map(c => [c.display, c.name.toLowerCase()])
    );
  </script>

<script type="module" src="/js/common.js"></script>

<script type="module">
  import { initSearchBar } from "/js/common.js";
  initSearchBar();
</script>

  <script>
    const city = "{{cityName}}";
    const BASE_PATH = "/";

    document.addEventListener("DOMContentLoaded", () => {
      const slug = window.citySlugMap?.[city] || city.toLowerCase();

      fetch(`${BASE_PATH}city-data/${slug}-top5.json`)
        .then(res => res.json())
        .then(data => {
          renderHotels(data.topRated, "hotelList-top");
          renderHotels(data.family, "hotelList-family");
          renderHotels(data.petFriendly, "hotelList-pet");
        })
        .catch(err => console.error("❌ 호텔 데이터 로드 실패:", err));

      document.querySelectorAll(".scroll-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          const target = document.getElementById(btn.dataset.target);
          if (!target) return;
          target.scrollBy({
            left: btn.classList.contains("left") ? -target.clientWidth * 0.9 : target.clientWidth * 0.9,
            behavior: "smooth"
          });
        });
      });
    });

function renderHotels(hotels, targetId) {
  // scroll-wrapper 안의 horizontal-scroll를 찾아야 함
  const wrapper = document.getElementById(targetId);
  if (!wrapper) return;

  // wrapper가 이미 horizontal-scroll라면 그대로 사용
  const el = wrapper.classList.contains("horizontal-scroll")
    ? wrapper
    : wrapper.querySelector(".horizontal-scroll");

  if (!el) return;

  if (!hotels?.length) {
    el.innerHTML = "<p style='text-align:center;color:#777;'>표시할 숙소가 없습니다.</p>";
    return;
  }

  const cards = hotels
    .map(
      (h) => `
        <div class="hotel-card">
          <img src="${h.image || "https://picsum.photos/seed/" + encodeURIComponent(h.name) + "/400/250"}" alt="${h.name}">
          <div class="hotel-info">
            <strong>${h.name}</strong>
            <p>📍 ${h.address || h.city}</p>
            <p>⭐ ${h.rating || "4.5"} / 5.0</p>
          </div>
        </div>`
    )
    .join("");

  // ✅ 기존 구조 유지, 카드만 주입
  el.innerHTML = cards;
}

document.addEventListener("click", (e) => {
  const btn = e.target.closest(".scroll-btn");
  if (!btn) return;

  const target = document.getElementById(btn.dataset.target);
  if (!target) return;

  const scroller = target.classList.contains("horizontal-scroll")
    ? target
    : target.querySelector(".horizontal-scroll");

  if (!scroller) return;

  const shift = scroller.clientWidth * 0.9 * (btn.classList.contains("left") ? -1 : 1);
  scroller.scrollBy({ left: shift, behavior: "smooth" });
});


  </script>
</body>
</html>
